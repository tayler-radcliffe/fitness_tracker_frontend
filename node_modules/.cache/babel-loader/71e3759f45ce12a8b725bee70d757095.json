{"ast":null,"code":"import _regeneratorRuntime from\"/home/tradcliffe/fitness_tracker/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/tradcliffe/fitness_tracker/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/tradcliffe/fitness_tracker/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Redirect,Link}from'react-router-dom';import{fetchUserRoutines,getCurrentToken,storeLoginToken}from'../api';import'./login.css';import FormControl from'@material-ui/core/FormControl';import{makeStyles}from'@material-ui/core/styles';import Button from'@material-ui/core/Button';import OutlinedInput from'@material-ui/core/OutlinedInput';import TextField from'@material-ui/core/TextField';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(_ref){var username=_ref.username,setUsername=_ref.setUsername,password=_ref.password,setPassword=_ref.setPassword,setCurrentUser=_ref.setCurrentUser,setMyRoutines=_ref.setMyRoutines,currentUser=_ref.currentUser;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var loginUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(username,password){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('https://fitnesstrac-kr.herokuapp.com/api/users/login',{method:\"POST\",headers:{'Content-Type':'application/json'},body:JSON.stringify({username:username,password:password})}).then(function(response){return response.json();}).then(function(result){console.log(result);if(result.error){alert(result.message);setUsername('');setPassword('');}else{var _token=result.token;console.log('This is your login token',_token);setToken(_token);storeLoginToken(_token);setUsername('');setPassword('');}}).catch(console.error);case 2:case\"end\":return _context.stop();}}},_callee);}));return function loginUser(_x,_x2){return _ref2.apply(this,arguments);};}();var handleClick=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event){var newRoutines;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:event.preventDefault();setCurrentUser(username);loginUser(username,password);_context2.next=5;return fetchUserRoutines(currentUser);case 5:newRoutines=_context2.sent;setMyRoutines(newRoutines);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function handleClick(_x3){return _ref3.apply(this,arguments);};}();var useStyles=makeStyles(function(theme){return{container:{display:'flex',flexWrap:'wrap'},formControl:{margin:theme.spacing(2),minWidth:120},textFields:{width:'250px',margin:theme.spacing(2),marginTop:'5px'}};});var classes=useStyles();if(token){return/*#__PURE__*/_jsx(Redirect,{to:\"/myroutines\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"login-container\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"login-form\",onSubmit:handleClick,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login here\"}),/*#__PURE__*/_jsxs(FormControl,{variant:\"outlined\",className:classes.formControl,children:[/*#__PURE__*/_jsx(TextField,{className:classes.textFields,type:\"text\",value:username,variant:\"outlined\",InputLabelProps:{shrink:true},label:\"Username\",min:\"8\",max:\"20\",required:true,onChange:function onChange(e){return setUsername(e.target.value);}}),/*#__PURE__*/_jsx(TextField,{className:classes.textFields,type:\"password\",value:password,variant:\"outlined\",InputLabelProps:{shrink:true},label:\"Password\",min:\"8\",max:\"20\",required:true,onChange:function onChange(e){return setPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:\"login-button\",children:/*#__PURE__*/_jsx(Button,{size:\"large\",type:\"submit\",color:\"primary\",variant:\"contained\",onClick:function onClick(){return handleClick;},children:\"Login\"})}),/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"login-link\",children:\"Don't have an account? Sign Up\"})]})]})});};export default Login;","map":{"version":3,"sources":["/home/tradcliffe/fitness_tracker/src/components/Login.js"],"names":["React","useState","Redirect","Link","fetchUserRoutines","getCurrentToken","storeLoginToken","FormControl","makeStyles","Button","OutlinedInput","TextField","Login","username","setUsername","password","setPassword","setCurrentUser","setMyRoutines","currentUser","token","setToken","loginUser","fetch","method","headers","body","JSON","stringify","then","response","json","result","console","log","error","alert","message","catch","handleClick","event","preventDefault","newRoutines","useStyles","theme","container","display","flexWrap","formControl","margin","spacing","minWidth","textFields","width","marginTop","classes","shrink","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Redirect, Link } from 'react-router-dom';\nimport { fetchUserRoutines, getCurrentToken, storeLoginToken } from '../api';\nimport './login.css'\nimport FormControl from '@material-ui/core/FormControl';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport OutlinedInput from '@material-ui/core/OutlinedInput';\nimport TextField from '@material-ui/core/TextField';\n\n\nconst Login = ({username, setUsername, password, setPassword, setCurrentUser, setMyRoutines, currentUser}) => {\n\n  const [token, setToken] = useState('');\n\n  const loginUser = async (username, password) => {\n    await fetch('https://fitnesstrac-kr.herokuapp.com/api/users/login', {\n      method: \"POST\",\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        username,\n        password\n      })\n    }).then(response => response.json())\n      .then(result => {\n        console.log(result);\n        if(result.error) {\n          alert(result.message);\n          setUsername('');\n          setPassword(''); \n        } else {\n        const token = result.token;\n        console.log('This is your login token', token)\n        setToken(token);\n        storeLoginToken(token);\n        setUsername('');\n        setPassword(''); \n        }\n      })\n      .catch(console.error);\n  };\n\n  const handleClick = async (event) => {\n      event.preventDefault();\n      setCurrentUser(username);\n      loginUser(username, password);\n      const newRoutines = await fetchUserRoutines(currentUser);\n      setMyRoutines(newRoutines);      \n  };\n\n  const useStyles = makeStyles((theme) => ({\n    container: {\n      display: 'flex',\n      flexWrap: 'wrap',\n    },\n    formControl: {\n      margin: theme.spacing(2),\n      minWidth: 120\n    },\n    textFields: {\n        width: '250px',\n        margin: theme.spacing(2),\n        marginTop: '5px'\n      },\n  }));\n\n  const classes = useStyles();\n\n\n  if(token) {\n    return <Redirect to = '/myroutines' /> }\n\n    return (\n    <div className=\"login-container\">\n        <form className=\"login-form\" onSubmit={handleClick}>\n        <h2>Login here</h2>\n        <FormControl variant=\"outlined\"  className={classes.formControl}>\n                \n                <TextField className={classes.textFields}\n                     type='text' \n                     value={username}\n                     variant=\"outlined\"\n                     InputLabelProps={{\n                      shrink: true,\n                    }} \n                     label='Username' \n                     min='8' max='20' required \n                     onChange={(e) => setUsername(e.target.value) }\n                />\n        \n                <TextField className={classes.textFields}\n                    type='password' \n                    value={password}\n                    variant=\"outlined\"\n                    InputLabelProps={{\n                      shrink: true,\n                    }} \n                    label='Password' \n                    min='8' max='20' required \n                    onChange={(e) => setPassword(e.target.value) }\n                />\n            <div className=\"login-button\">\n                <Button \n                  size='large'\n                  type='submit'\n                  color='primary'\n                  variant=\"contained\"\n                  onClick={() => handleClick}>Login</Button>\n            </div> \n            \n          <Link to=\"/\" className='login-link'>Don't have an account? Sign Up</Link>\n          </FormControl>\n        </form>\n    </div>\n    )\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}